apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/instance: rsyslog
    app.kubernetes.io/name: rsyslog
  name: rsyslog
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/instance: rsyslog
      app.kubernetes.io/name: rsyslog
  strategy: {}
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: rsyslog
        app.kubernetes.io/name: rsyslog
    spec:
      containers:
      - image: rsyslog/syslog_appliance_alpine@sha256:c0dd7cad9ff3234967ff59879590175b7590e8a5f5621ec49a85aff546b44a3b
        name: syslog
        env:
        - name: RSYSLOG_CONF
          value: /config/rsyslog.conf
        volumeMounts:
        - mountPath: /config
          name: config
        - mountPath: /work
          name: work
        - mountPath: /log
          name: log
      - image: telegraf:1.23.4@sha256:5e7104dde3663cd4ecf3bb20c25a0d81739ed5eab32d7b522b91f3bed4d9341c
        name: telegraf
        volumeMounts:
        - mountPath: /log
          name: log
        - mountPath: /etc/telegraf
          name: telegraf-syslog
      volumes:
        - name: config
          configMap:
            name: rsyslog
        - name: telegraf-syslog
          configMap:
            name: telegraf-syslog
        - name: work
          emptyDir: {}
        - name: log
          emptyDir: {}
